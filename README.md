# Распределённый вычислитель арифметических выражений
## Описание проекта

Этот проект представляет собой распределённый вычислитель арифметических выражений, который состоит из двух основных компонентов:

1. **Оркестратор** — сервер, который принимает арифметические выражения, разбивает их на задачи и управляет их выполнением.
2. **Агент** — вычислитель, который получает задачи от оркестратора, выполняет их и возвращает результаты.

Проект разработан для работы с длительными арифметическими операциями, которые выполняются на отдельных вычислительных узлах (агентах). Это позволяет масштабировать систему, добавляя новые агенты для увеличения вычислительной мощности.

---

## Как это работает

1. Пользователь отправляет арифметическое выражение на сервер (оркестратор).
2. Оркестратор разбивает выражение на отдельные задачи (операции) и добавляет их в очередь.
3. Агенты запрашивают задачи у оркестратора, выполняют их и возвращают результаты.
4. Оркестратор объединяет результаты задач и вычисляет итоговое значение выражения.
5. Пользователь может запросить статус выполнения выражения и получить результат, когда он будет готов.

---

## Веб-интерфейс

Веб-интерфейс позволяет пользователю взаимодействовать с системой через браузер. Он предоставляет следующие возможности:

1. **Отправка выражения на вычисление**:
   - Пользователь вводит выражение в текстовое поле и нажимает кнопку "Вычислить".
   - Выражение отправляется на сервер, и пользователь получает ID задачи.

2. **Проверка статуса задачи**:
   - Пользователь может ввести ID задачи и нажать кнопку "Проверить статус".
   - Веб-интерфейс отображает текущий статус задачи и результат (если он готов).

3. **Просмотр списка всех выражений**:
   - Пользователь может нажать кнопку "Показать все выражения", чтобы увидеть список всех отправленных выражений и их статусов.

---

### Как использовать веб-интерфейс

1. Перейдите по адресу `http://localhost:8080` в браузере.
2. Введите выражение в поле "Введите выражение" и нажмите "Вычислить".
3. Чтобы проверить статус задачи, введите ID задачи и нажмите "Проверить статус".
4. Чтобы увидеть все выражения, нажмите "Показать все выражения".

## Запуск проекта

### Требования

- Установленный Go (версия 1.20 или выше).

### Запуск

1. Склонируйте репозиторий:

   ```bash
   git clone *link*
   cd distributed-calculator
   ```

2. Запустите оркестратор:

   ```bash
   go run ./cmd/orch/main.go
   ```

3. Запустите агентов (в отдельных терминалах):

   ```bash
   go run ./cmd/agent/main.go
   ```

   Вы можете запустить несколько агентов для увеличения вычислительной мощности.

---

## Примеры запросов

### 1. Добавление выражения для вычисления

Отправьте POST-запрос с арифметическим выражением:

```bash
curl --location 'http://localhost:8080/api/v1/calculate' \
--header 'Content-Type: application/json' \
--data '{
  "expression": "2+2*2"
}'
```

**Ответ:**

```json
{
  "id": "expr-1"
}
```

### 2. Получение списка всех выражений

Отправьте GET-запрос для получения списка всех выражений:

```bash
curl --location 'http://localhost:8080/api/v1/expressions'
```

**Ответ:**

```json
{
  "expressions": [
    {
      "id": "expr-1",
      "status": "completed",
      "result": 6
    },
    {
      "id": "expr-2",
      "status": "pending",
      "result": 0
    }
  ]
}
```

### 3. Получение выражения по ID

Отправьте GET-запрос с ID выражения:

```bash
curl --location 'http://localhost:8080/api/v1/expressions/expr-1'
```

**Ответ:**

```json
{
  "expression": {
    "id": "expr-1",
    "status": "completed",
    "result": 6
  }
}
```

### 4. Получение задачи для агента

Агенты автоматически запрашивают задачи у оркестратора. Пример запроса:

```bash
curl --location 'http://localhost:8080/internal/task'
```

**Ответ:**

```json
{
  "task": {
    "id": "task-1",
    "arg1": 2,
    "arg2": 2,
    "operation": "*",
    "operation_time": 1000
  }
}
```

### 5. Отправка результата выполнения задачи

Агенты отправляют результаты выполнения задач:

```bash
curl --location 'http://localhost:8080/internal/task' \
--header 'Content-Type: application/json' \
--data '{
  "id": "task-1",
  "result": 4
}'
```

**Ответ:**

- Код `200 OK`, если результат успешно принят.
- Код `404 Not Found`, если задача не найдена.

---

## Структура проекта

```
calculator/
│   go.mod
│   go.sum
│   README.md
│   
├───cmd
│   ├───agent
│   │       main.go
│   │       
│   └───orch
│           main.go
│
├───internals
│   ├───calculator
│   │       calculator.go
│   │       calculator_test.go
│   │       
│   ├───config
│   │       config.go
│   │       
│   ├───handlers
│   │       handlers.go
│   │       handlers_test.go
│   │
│   └───models
│           models.go
│
└───web
        index.html
        script.js
        styles.css
```

---

## Тестирование

Для запуска тестов используйте команду:

```bash
go test ./...
```

Тесты покрывают логику вычисления арифметических выражений и обработчики HTTP-запросов.

---


## Автор

Федя
ТГ: @Rodef228

---

Этот `README.md` предоставляет полную информацию о проекте, включая инструкции по запуску, примеры запросов и описание структуры. Вы можете адаптировать его под свои нужды.
